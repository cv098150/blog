---
layout: post
title: yield 簡易應用
categories: php
---

同時大量執行郵件寄出，取得要寄信的資料時，使用yield 函式來實作
(以下使用 `zend framework`)

```php
// 由yield丟出來的值為物件，需要用foreach才能取得資料
$data = $this->getResultApplyList();

foreach ($data as $apply) {
    #... 省略

    $this->sendMail($apply['sn']);
}
```

### 因取出來的資料已是多筆，所以要在foreach裡面單筆丟出

```php
/**
 * 取得複審截止前活動
 * @return array
 * @author maggie 2021/8/16 下午 03:20
 */
public function getResultApplyList()
{
  $now = date('Y-m-d');
  $applyList =  $this->_applyModel->getAdapter()
      ->select()
      ->from('apply')
      ->query()
      ->fetchAll();

  foreach ($applyList as $apply) {
      yield $apply;
  }

}
```